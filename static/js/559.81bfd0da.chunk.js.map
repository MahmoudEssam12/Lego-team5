{"version":3,"file":"static/js/559.81bfd0da.chunk.js","mappings":"8JAAA,SAASA,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQC,EAAKC,GACpE,IACE,IAAIC,EAAOP,EAAIK,GAAKC,GAChBE,EAAQD,EAAKC,MACjB,MAAOC,GAEP,YADAP,EAAOO,GAILF,EAAKG,KACPT,EAAQO,GAERG,QAAQV,QAAQO,GAAOI,KAAKT,EAAOC,GAIxB,SAASS,EAAkBC,GACxC,OAAO,WACL,IAAIC,EAAOC,KACPC,EAAOC,UACX,OAAO,IAAIP,SAAQ,SAAUV,EAASC,GACpC,IAAIF,EAAMc,EAAGK,MAAMJ,EAAME,GAEzB,SAASd,EAAMK,GACbT,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,OAAQI,GAGlE,SAASJ,EAAOgB,GACdrB,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,QAASgB,GAGnEjB,OAAMkB,O,wDC/BNC,EAAG,mCAEF,SAAeC,EAAtB,iDAAO,OAAP,cAAO,WAA4BC,EAAUC,GAAtC,+FACqBC,OAAQ,OAAQC,KAAM,MAASF,GAAlDC,EADF,EACEA,OAAQC,EADV,EACUA,KADV,SAEiBC,MAAM,GAAD,OAAIN,EAAJ,YAAWE,IAAX,QAAC,QAC5BE,OAAAA,GACIC,GAAQ,CAAEA,KAAME,KAAKC,UAAUH,KAFR,IAG3BI,QAAS,CACR,eAAgB,uBANZ,cAEAC,EAFA,yBASCA,EAASC,QATV,kE,2DCOQ,SAASC,IACvB,OAAgBC,EAAAA,EAAAA,WAAS,kBAAMC,EAAAA,EAAAA,GAAWC,aAAaC,QAAQ,UAAUC,SAAlEA,GAAP,eAEMC,GAAOC,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMF,QACpCG,EAAeC,OAAOC,OAAOL,EAAKM,UACxC,GAAwCX,EAAAA,EAAAA,WAAS,GAAjD,eACA,GADA,WACkDA,EAAAA,EAAAA,WAAS,IAA3D,eAAOY,EAAP,KAA0BC,EAA1B,KACA,GAAsDb,EAAAA,EAAAA,UAAS,IAA/D,eAAOc,EAAP,KAA4BC,EAA5B,KACMC,EAAYR,EAAaS,KAAI,SAACC,GACnC,MAAO,CACNC,SAAUD,EAAQC,SAClBC,MAAOF,EAAQG,KACfC,OAAQJ,EAAQI,OAAOL,KAAI,SAACM,GAAD,6CAA2CA,MACtEC,MAAON,EAAQM,UAGXC,EAAe,SAACC,EAAOC,GACb,cAAXA,GAGJd,GAAqB,IAEhBe,GAASC,EAAAA,EAAAA,aACTC,EAAc,6BAAG,WAAOC,GAAP,oFACtBA,EAAEC,mBADoB,WAEH/B,EAAAA,EAAAA,GAAWC,aAAaC,QAAQ,iBAF7B,iBAEH,EAA2C8B,YAFxC,aAEH,EAAiDC,SAF9C,gBAIrBrB,GAAqB,GACrBE,EAAuB,+CALF,8BAOfoB,EAAanB,EAAUC,KAAI,SAACmB,GACjC,MAAO,CACNjB,SAAUiB,EAAKjB,SACfkB,WAAY,CACXC,SAAU,MACVC,YAA0B,IAAbH,EAAKZ,MAClBgB,aAAc,CACbnB,KAAMe,EAAKhB,MACXqB,YAAaL,EAAKK,YAClBnB,OAAQc,EAAKd,aAhBI,UAqBElC,EAAa,0BAA2B,CAC9DI,KAAM,CAAE2C,WAAAA,EAAYO,eAAgBtC,EAAOuC,WAAYtC,EAAKsC,cAtBxC,eAqBf9C,EArBe,OAwBb+C,EAAc/C,EAAd+C,UAxBa,UAyBGhB,EAAOiB,mBAAmB,CACjDD,UAAAA,IA1BoB,uBAyBbtE,MAzBa,uFAAH,sDAkCpB,OACC,kBAAMwE,SAAUhB,EAAhB,WACC,4BACC,kBAAOiB,UAAQ,EAACC,KAAK,QAAQC,YAAY,QAAQ5E,MAAO+B,EAAO8C,UAAU,wBA1DvD,6CA2DHC,KAAK/C,IAAoB,KAAVA,IAAgB,cAAG8C,UAAU,QAAb,6CAE/C,gBAAKA,UAAU,gBAAf,UACC,mBAAQF,KAAK,SAASE,UAAU,kBAAhC,yBAID,SAACE,EAAA,EAAD,CAAUC,KAAMzC,EAAmB0C,iBAAkB,IAAMC,QAAS9B,EAAc+B,SAAS,QAA3F,UACC,SAACC,EAAA,EAAD,CAAOF,QAAS9B,EAAc+B,SAAS,QAAQE,GAAI,CAAEC,MAAO,QAA5D,SACE7C,SC1ES,SAAS8C,IAEvB,IAAMC,GAAkBvD,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMF,KAAKwD,mBACpDlB,GAAarC,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMF,KAAKsC,cAErD,OACC,iBAAKO,UAAU,WAAf,WACC,8CACA,+CAAqBW,MACrB,iDACClB,EAAa,IAAOA,EAAWmB,QAAQ,GAAKC,OAAOpB,EAAWmB,QAAQ,IAAM,GAD7E,WAGA,SAAC/D,EAAD","sources":["../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","helpers.js","components/Checkout/stripe-checkout/stripe-checkout.jsx","components/Checkout/Checkout.jsx"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","const API = `https://lego-team5.herokuapp.com`;\r\n\r\nexport async function fetchFromAPI(endpoint, options) {\r\n\tconst { method, body } = { method: \"POST\", body: null, ...options };\r\n\tconst response = await fetch(`${API}/${endpoint}`, {\r\n\t\tmethod,\r\n\t\t...(body && { body: JSON.stringify(body) }),\r\n\t\theaders: {\r\n\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t},\r\n\t});\r\n\treturn response.json();\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { useStripe } from \"@stripe/react-stripe-js\";\r\nimport { fetchFromAPI } from \"../../../helpers\";\r\nimport { useSelector } from \"react-redux\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport Snackbar from \"@mui/material/Snackbar\";\r\nimport Alert from \"@mui/material/Alert\";\r\n// import cart redux\r\n\r\nexport default function StripeCheckout() {\r\n\tconst [email] = useState(() => jwt_decode(localStorage.getItem(\"token\")).email);\r\n\tconst emailPattern = /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(.\\w{2,3})+$/;\r\n\tconst cart = useSelector((store) => store.cart);\r\n\tconst cartProducts = Object.values(cart.products);\r\n\tconst [notification, setNotification] = useState(false);\r\n\tconst [errorNotification, setErrorNotification] = useState(false);\r\n\tconst [notificationMessage, setNotificationMessage] = useState(\"\");\r\n\tconst cartItems = cartProducts.map((product) => {\r\n\t\treturn {\r\n\t\t\tquantity: product.quantity,\r\n\t\t\ttitle: product.name,\r\n\t\t\timages: product.images.map((image) => `http://localhost:8080/images/${image}`),\r\n\t\t\tprice: product.price,\r\n\t\t};\r\n\t});\r\n\tconst hideErrorMsg = (event, reason) => {\r\n\t\tif (reason === \"clickaway\") {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetErrorNotification(false);\r\n\t};\r\n\tconst stripe = useStripe();\r\n\tconst handleCheckout = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tconst blockState = jwt_decode(localStorage.getItem(\"token\"))?.user?.blocked;\r\n\t\tif (blockState) {\r\n\t\t\tsetErrorNotification(true);\r\n\t\t\tsetNotificationMessage(\"you have breached our rules you are blocked\");\r\n\t\t} else {\r\n\t\t\tconst line_items = cartItems.map((item) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tquantity: item.quantity,\r\n\t\t\t\t\tprice_data: {\r\n\t\t\t\t\t\tcurrency: \"egp\",\r\n\t\t\t\t\t\tunit_amount: item.price * 100,\r\n\t\t\t\t\t\tproduct_data: {\r\n\t\t\t\t\t\t\tname: item.title,\r\n\t\t\t\t\t\t\tdescription: item.description,\r\n\t\t\t\t\t\t\timages: item.images, // array of images\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tconst response = await fetchFromAPI(\"create-checkout-session\", {\r\n\t\t\t\tbody: { line_items, customer_email: email, totalPrice: cart.totalPrice },\r\n\t\t\t});\r\n\t\t\tconst { sessionId } = response;\r\n\t\t\tconst { error } = await stripe.redirectToCheckout({\r\n\t\t\t\tsessionId,\r\n\t\t\t});\r\n\t\t\tif (error) {\r\n\t\t\t\treturn;\r\n\t\t\t\t// show user an error\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn (\r\n\t\t<form onSubmit={handleCheckout}>\r\n\t\t\t<div>\r\n\t\t\t\t<input disabled type=\"email\" placeholder=\"Email\" value={email} className=\"stripe-email-input\" />\r\n\t\t\t\t{!emailPattern.test(email) && email !== \"\" && <p className=\"error\">Enter a Valid Email Address</p>}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"submit-button\">\r\n\t\t\t\t<button type=\"submit\" className=\"checkout-button\">\r\n\t\t\t\t\tCheckout\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<Snackbar open={errorNotification} autoHideDuration={3000} onClose={hideErrorMsg} severity=\"error\">\r\n\t\t\t\t<Alert onClose={hideErrorMsg} severity=\"error\" sx={{ width: \"100%\" }}>\r\n\t\t\t\t\t{notificationMessage}\r\n\t\t\t\t</Alert>\r\n\t\t\t</Snackbar>\r\n\t\t</form>\r\n\t);\r\n}\r\n","import React from \"react\";\r\nimport StripeCheckout from \"./stripe-checkout/stripe-checkout\";\r\nimport \"./Checkout.css\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nexport default function Checkout() {\r\n\t// comes from the cart redux\r\n\tconst totalItemsCount = useSelector((store) => store.cart.totalItemsCount);\r\n\tconst totalPrice = useSelector((store) => store.cart.totalPrice);\r\n\t// const { itemCount, total } = { itemCount: 1, total: 2000 };\r\n\treturn (\r\n\t\t<div className=\"checkout\">\r\n\t\t\t<h2>Checkout Summary</h2>\r\n\t\t\t<h3>{`Total Items: ${totalItemsCount}`}</h3>\r\n\t\t\t<h4>{`Amount to Pay: ${\r\n\t\t\t\ttotalPrice > 1000 ? totalPrice.toFixed(2) : Number(totalPrice.toFixed(2)) + 30\r\n\t\t\t} EGP`}</h4>\r\n\t\t\t<StripeCheckout />\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","API","fetchFromAPI","endpoint","options","method","body","fetch","JSON","stringify","headers","response","json","StripeCheckout","useState","jwt_decode","localStorage","getItem","email","cart","useSelector","store","cartProducts","Object","values","products","errorNotification","setErrorNotification","notificationMessage","setNotificationMessage","cartItems","map","product","quantity","title","name","images","image","price","hideErrorMsg","event","reason","stripe","useStripe","handleCheckout","e","preventDefault","user","blocked","line_items","item","price_data","currency","unit_amount","product_data","description","customer_email","totalPrice","sessionId","redirectToCheckout","onSubmit","disabled","type","placeholder","className","test","Snackbar","open","autoHideDuration","onClose","severity","Alert","sx","width","Checkout","totalItemsCount","toFixed","Number"],"sourceRoot":""}